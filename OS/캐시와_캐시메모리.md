# 🚄 캐시와 캐시 메모리, 캐싱
자주 헷갈리는 캐시 메모리와 캐시, 캐싱이라는 용어에 대해 조금 더 자세히 알아보자.

## 캐시 메모리 (Cache Memory)
먼저, 캐시 메모리는 흔히 [메모리의 계층구조](%EB%A9%94%EB%AA%A8%EB%A6%AC%EC%9D%98_%EA%B3%84%EC%B8%B5%EA%B5%AC%EC%A1%B0.md)에서 말하는
CPU와 주 기억장치 사이에 위치한 '특정한 종류의 캐시'를 가리키는 용어이다.

캐시 메모리는 보통 SRAM을 말하고, L1, L2, L3의 세 단계로 나뉘어서 CPU가 데이터를 직접 가져오고 
저장할 수 있도록 한다.

## 캐시 (Cache)
그렇다면 캐시는 무엇일까?    
캐시는 느린 기억장치와 빠른 기억장치 간의 속도 차이를 극복하기 위해 '중간 단계로 사용되는 메모리'를 일반적으로 일컫는 용어이다. 

예를 들어, 캐시 메모리와 보조 기억장치 간의 속도 차를 해결하기 위한 캐싱 계층은 '주 기억장치'가 되고,
CPU '캐시'는 CPU와 메인 메모리(RAM) 사이에서 데이터를 더 빠르게 엑세스할 수 있도록 돕는다.    

이때 사용되는 캐시는 각각의 계층 사이에서 데이터에 대한 접근 속도를 향상시키고, 전체 시스템의 성능을 향상시키는 데에 기여하게 된다.

그리고 이러한 `캐시`에 반복적인 데이터를 효율적으로 처리하기 위해 사용되는 기술이 바로 `캐싱(caching)`이다.


앞으로 설명할 내용은 모두 보편적인 캐시에 해당하는 내용임을 기억하자.


### 캐시의 성능
- `캐시 히트`
    - 캐시에서 원하는 데이터를 찾은 경우, 캐시에서 바로 데이터를 읽어오는 것

- `캐시 미스`
    - 해당 데이터가 캐시에 없어서 다음 계층에서 데이터를 찾아오는 것

캐시 히트의 비율을 `캐시 적중률(Hit Ratio)`이라고 하며, 캐시의 성능은 주로 적중률에 비례하게 된다.

### 캐시의 지역성
캐시가 효율적으로 동작하려면 캐시의 적중률을 극대화 시켜야하므로,   
캐시에 저장할 데이터가 지역성(Locality)을 가져야 한다.
여기서 지역성이란, 기억장치 내의 정보를 균일하게 Access하는 것이 아닌 어느 한 순간에 특정 부분을 집중적으로 참조하는 특성이다.

- 시간 지역성: 최근 사용한 데이터에 다시 접근하려는 특성
- 공간 지역성: 최근 접근한 데이터의 주소나 인접한 주소에 접근하려는 특성

### 캐시 매핑
캐시가 히트되기 위해 메모리와 매핑하는 방법
- 직접 매핑
    - 메모리 100개 당 캐시 10을 매핑하는 등, 순서를 일치시키는 방식
    - 처리 속도는 빠르지만 충돌이 자주 발생한다.
- 연관 매핑
    - 순서를 일치시키지 않고 관련있는 캐시와 메모리를 매핑하는 방법
    - 충돌이 적지만 모든 블록을 탐색해야 하므로 속도가 느리다.
- 집합 연관 매핑
    - 직접 매핑 + 연관 매핑
    - 순서를 일치시킴과 동시에 블록화하여 저장하는 방법
    - ex) 메모리 1 ~ 100, 캐시 1 ~ 10이 있다면 캐시 1 ~ 5에는 1 ~ 50의 데이터를 블록화하여 무작위로 저장한다.


### 캐시의 활용
캐시의 특성이 활용되는 것을 간략히 정리하면 다음과 같다.
아래의 예시 이외에도 CPU 칩이나 분산 파일 시스템에서 캐시가 사용된다.

#### 웹 브라우저의 캐시
사용자의 커스텀 정보나 인증 모듈 등의 사항을 웹 브라우저에 저장하여,
추후 서버에 요청할 때 중복 요청을 방지하기 위해 쓰인다.

`쿠키`
- 만료기한이 있는 Key-Value 저장소
- 데이터를 4KB까지 저장할 수 있다.
- same site 옵션을 strict로 설정하지 않았을 경우, 다른 도메인에서 요청했을 때 자동 전송된다.
- `httponly` 옵션을 걸어, `document.cookie`로 쿠키를 볼 수 없게 하는 것이 중요하다.

`로컬 스토리지`
- 만료기한이 없는 Key-Value 저장소
- 데이터를 5MB까지 저장할 수 있다.
- 도메인 단위로 저장/생성되며, 웹 브라우저를 닫아도 유지된다.
- 클라이언트에서만 수정 가능하다.

`세션 스토리지`
- 만료기한이 없는 Key-Value 저장소
- 데이터를 대략 5MB까지 저장할 수 있으며, 이는 브라우저마다 다를 수 있다.
- 탭 단위로 생성하며, 탭을 닫을 때 해당 데이터가 삭제된다.
- 클라이언트에서만 수정 가능하다.

#### DB의 캐싱 계층
메인 DB 위에 `레디스(redis)`캐시를 두어 이 계층을 캐싱 계층으로 사용하기도 한다.



-------------------------------------------------


### References
- https://velog.io/@eddy_song/memory-hierarchy
- https://chelseashin.tistory.com/43