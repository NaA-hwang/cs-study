# 💾 메모리
메모리란 프로세스 실행 시에 CPU가 필요한 주소나 정보를 저장하고 액세스하여 사용할 수 있도록 하는 공간을 의미한다.

## 메모리 계층
메모리 계층 구조란 메모리를 필요에 따라 단계적으로 나누어 둔 것을 의미한다.     
메모리의 종류는 [레지스터](#1-레지스터), [캐시](#2-캐시), [메모리(RAM)](#3-메모리주-기억장치), [저장장치](#4-저장장치보조-기억장치)가 있으며,
메모리들은 아래 그림과 같이 피라미드처럼 계층적인 구조를 가진다.

<img src="images/memory_hierarchy" width="500" height="300">

이러한 계층적인 구조를 가지는 이유는 결론적으로 CPU와 메모리의 성능 차이를 보완하기 위함이다.   
CPU가 빠르게 연산을 수행해도, 데이터에 접근하는 과정의 속도가 느리면 전체적인 처리 속도가 느려진다.  
이를 개선하기 위해 메모리들에 계층을 두는 것이며, 이를 통해 프로그램을 효율적으로 실행할 수 있다.

### 1. 레지스터
- CPU 내의 메모리
- 휘발성
- 속도 가장 빠름 / 기억 용량 가장 적음

### 2. 캐시
- L1, L2 캐시를 지칭한다. (L3 캐시도 있다.)
- 데이터를 미리 복사해놓는 임시 저장소
- 빠른 장치(CPU)와 느린 장치(메모리)에서 속도 차이에 따른 병목 현상을 줄이기 위한 메모리
> `캐싱 계층` 
> 
> 계층과 계층 사이에서 속도를 해결하는 계층을 의미한다.
> 
>  ex ) 캐시 메모리와 보조 기억장치 간의 속도차를 해결하기 위한 캐싱 계층은 '주 기억장치'가 된다.

#### 캐시 히트와 캐시 미스
- `캐시 히트` 
  - 캐시에서 원하는 데이터를 찾은 경우, 제어장치를 통해 가져오는 것
  - CPU 내부 버스를 이용하므로 동작 속도가 빠르다.
    
- `캐시 미스`
  - 해당 데이터가 캐시에 없어서 주메모리에서 데이터를 찾아오는 것
  - 시스템 버스를 이용하므로 동작 속도가 느리다.

<br>

#### 캐시 매핑
캐시 계층에서 캐시가 히트되기 위해 메모리와 매핑하는 방법
- 직접 매핑
  - 메모리 100개 당 캐시 10을 매핑하는 등, 순서를 일치시키는 방식
  - 처리 속도는 빠르지만 충돌이 자주 발생한다.
- 연관 매핑
  - 순서를 일치시키지 않고 관련있는 캐시와 메모리를 매핑하는 방법
  - 충돌이 적지만 모든 블록을 탐색해야 하므로 속도가 느리다.
- 집합 연관 매핑
  - 직접 매핑 + 연관 매핑
  - 순서를 일치시킴과 동시에 블록화하여 저장하는 방법
  - ex) 메모리 1~100, 캐시 1~10이 있다면 캐시 1~5에는 1~50의 데이터를 블록화하여 무작위로 저장한다.

<br>

#### 지역성의 원리
캐시 계층을 두지 않고, 자주 사용한 데이터를 기반으로 캐시를 직접 설정하는 것
- 시간 지역성: 최근 사용한 데이터에 다시 접근하려는 특성
- 공간 지역성: 최근 접근한 데이터의 주소나 인접한 주소에 접근하려는 특성

🔗 [캐시의 활용](#캐시의-활용)

### 3. 메모리(주 기억장치)
- RAM을 가리킴
- 하드디스크로부터 데이터를 복사해서 임시저장하고, 이를 필요시마다 CPU에 빠르게 전달한다.


### 4. 저장장치(보조 기억장치)
- HDD, SSD를 일컫는다.
- 비휘발성
- 속도가 가장 낮음 / 기억 용량 가장 많음


## 캐시의 활용
### 웹 브라우저의 캐시
사용자의 커스텀 정보나 인증 모듈 등의 사항을 웹 브라우저에 저장하여, 
추후 서버에 요청할 때 중복 요청을 방지하기 위해 쓰인다.

#### 쿠키
- 만료기한이 있는 Key-Value 저장소
- 데이터를 4KB까지 저장할 수 있다.
- same site 옵션을 strict로 설정하지 않았을 경우, 다른 도메인에서 요청했을 때 자동 전송된다.
- `httponly` 옵션을 걸어, `document.cookie`로 쿠키를 볼 수 없게 하는 것이 중요하다.

#### 로컬 스토리지
- 만료기한이 없는 Key-Value 저장소
- 데이터를 10KB까지 저장할 수 있다.
- 도메인 단위로 저장/생성되며, 웹 브라우저를 닫아도 유지된다.
- 클라이언트에서만 수정 가능하다.

#### 세션 스토리지
- 만료기한이 없는 Key-Value 저장소
- 데이터를 5KB까지 저장할 수 있다.
- 탭 단위로 생성하며, 탭을 닫을 때 해당 데이터가 삭제된다.
- 클라이언트에서만 수정 가능하다.

### DB의 캐싱 계층
메인 DB 위에 `레디스(redis)`캐시를 두어 이 계층을 캐싱 계층으로 사용하기도 한다.


-------------------------------------------------


면접 예상 질문
---



References
---
- https://joooing.tistory.com/entry/cs3